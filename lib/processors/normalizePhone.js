"use strict";

require("source-map-support/register");

const {
  _,
  replaceAll
} = require('rk-utils');

function normalizePhone(phone, defaultArea) {
  if (phone) {
    phone = phone.trim();

    if (phone.length > 0) {
      let s = phone[0];

      if (s === '+') {} else if (s === '0') {
        if (phone[1] === '0') {
          phone = '+' + phone.substr(2);
        } else {
          phone = defaultArea + phone.substr(1);
        }
      } else {
        phone = defaultArea + phone;
      }

      let leftB = phone.indexOf('(');
      let rightB = phone.indexOf(')');

      if (leftB > 0 && rightB > leftB) {
        phone = phone.substr(0, leftB) + _.trimStart(phone.substring(leftB + 1, rightB), '0') + phone.substr(rightB + 1);
      }

      phone = phone.replace(/\ |\-/g, '');
    }
  }

  return phone;
}

module.exports = normalizePhone;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wcm9jZXNzb3JzL25vcm1hbGl6ZVBob25lLmpzIl0sIm5hbWVzIjpbIl8iLCJyZXBsYWNlQWxsIiwicmVxdWlyZSIsIm5vcm1hbGl6ZVBob25lIiwicGhvbmUiLCJkZWZhdWx0QXJlYSIsInRyaW0iLCJsZW5ndGgiLCJzIiwic3Vic3RyIiwibGVmdEIiLCJpbmRleE9mIiwicmlnaHRCIiwidHJpbVN0YXJ0Iiwic3Vic3RyaW5nIiwicmVwbGFjZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxNQUFNO0FBQUVBLEVBQUFBLENBQUY7QUFBS0MsRUFBQUE7QUFBTCxJQUFvQkMsT0FBTyxDQUFDLFVBQUQsQ0FBakM7O0FBRUEsU0FBU0MsY0FBVCxDQUF3QkMsS0FBeEIsRUFBK0JDLFdBQS9CLEVBQTRDO0FBQ3hDLE1BQUlELEtBQUosRUFBVztBQUNQQSxJQUFBQSxLQUFLLEdBQUdBLEtBQUssQ0FBQ0UsSUFBTixFQUFSOztBQUVBLFFBQUlGLEtBQUssQ0FBQ0csTUFBTixHQUFlLENBQW5CLEVBQXNCO0FBQ2xCLFVBQUlDLENBQUMsR0FBR0osS0FBSyxDQUFDLENBQUQsQ0FBYjs7QUFDQSxVQUFJSSxDQUFDLEtBQUssR0FBVixFQUFlLENBRWQsQ0FGRCxNQUVPLElBQUlBLENBQUMsS0FBSyxHQUFWLEVBQWU7QUFDbEIsWUFBSUosS0FBSyxDQUFDLENBQUQsQ0FBTCxLQUFhLEdBQWpCLEVBQXNCO0FBQ2xCQSxVQUFBQSxLQUFLLEdBQUcsTUFBTUEsS0FBSyxDQUFDSyxNQUFOLENBQWEsQ0FBYixDQUFkO0FBQ0gsU0FGRCxNQUVPO0FBQ0hMLFVBQUFBLEtBQUssR0FBR0MsV0FBVyxHQUFHRCxLQUFLLENBQUNLLE1BQU4sQ0FBYSxDQUFiLENBQXRCO0FBQ0g7QUFDSixPQU5NLE1BTUE7QUFDSEwsUUFBQUEsS0FBSyxHQUFHQyxXQUFXLEdBQUdELEtBQXRCO0FBQ0g7O0FBRUQsVUFBSU0sS0FBSyxHQUFHTixLQUFLLENBQUNPLE9BQU4sQ0FBYyxHQUFkLENBQVo7QUFDQSxVQUFJQyxNQUFNLEdBQUdSLEtBQUssQ0FBQ08sT0FBTixDQUFjLEdBQWQsQ0FBYjs7QUFFQSxVQUFJRCxLQUFLLEdBQUcsQ0FBUixJQUFhRSxNQUFNLEdBQUdGLEtBQTFCLEVBQWlDO0FBQzdCTixRQUFBQSxLQUFLLEdBQUdBLEtBQUssQ0FBQ0ssTUFBTixDQUFhLENBQWIsRUFBZ0JDLEtBQWhCLElBQXlCVixDQUFDLENBQUNhLFNBQUYsQ0FBWVQsS0FBSyxDQUFDVSxTQUFOLENBQWdCSixLQUFLLEdBQUMsQ0FBdEIsRUFBeUJFLE1BQXpCLENBQVosRUFBOEMsR0FBOUMsQ0FBekIsR0FBOEVSLEtBQUssQ0FBQ0ssTUFBTixDQUFhRyxNQUFNLEdBQUMsQ0FBcEIsQ0FBdEY7QUFDSDs7QUFFRFIsTUFBQUEsS0FBSyxHQUFHQSxLQUFLLENBQUNXLE9BQU4sQ0FBYyxRQUFkLEVBQXdCLEVBQXhCLENBQVI7QUFDSDtBQUNKOztBQUVELFNBQU9YLEtBQVA7QUFDSDs7QUFFRFksTUFBTSxDQUFDQyxPQUFQLEdBQWlCZCxjQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgXywgcmVwbGFjZUFsbCB9ID0gcmVxdWlyZSgncmstdXRpbHMnKTtcblxuZnVuY3Rpb24gbm9ybWFsaXplUGhvbmUocGhvbmUsIGRlZmF1bHRBcmVhKSB7XG4gICAgaWYgKHBob25lKSB7XG4gICAgICAgIHBob25lID0gcGhvbmUudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHBob25lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGxldCBzID0gcGhvbmVbMF07XG4gICAgICAgICAgICBpZiAocyA9PT0gJysnKSB7XG4gICAgICAgICAgICAgICAgLy9ub3RoaW5nXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHMgPT09ICcwJykge1xuICAgICAgICAgICAgICAgIGlmIChwaG9uZVsxXSA9PT0gJzAnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBob25lID0gJysnICsgcGhvbmUuc3Vic3RyKDIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBob25lID0gZGVmYXVsdEFyZWEgKyBwaG9uZS5zdWJzdHIoMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwaG9uZSA9IGRlZmF1bHRBcmVhICsgcGhvbmU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBsZWZ0QiA9IHBob25lLmluZGV4T2YoJygnKTtcbiAgICAgICAgICAgIGxldCByaWdodEIgPSBwaG9uZS5pbmRleE9mKCcpJyk7XG5cbiAgICAgICAgICAgIGlmIChsZWZ0QiA+IDAgJiYgcmlnaHRCID4gbGVmdEIpIHtcbiAgICAgICAgICAgICAgICBwaG9uZSA9IHBob25lLnN1YnN0cigwLCBsZWZ0QikgKyBfLnRyaW1TdGFydChwaG9uZS5zdWJzdHJpbmcobGVmdEIrMSwgcmlnaHRCKSwgJzAnKSArIHBob25lLnN1YnN0cihyaWdodEIrMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBob25lID0gcGhvbmUucmVwbGFjZSgvXFwgfFxcLS9nLCAnJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcGhvbmU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gbm9ybWFsaXplUGhvbmU7Il19