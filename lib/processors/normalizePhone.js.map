{"version":3,"sources":["../../src/processors/normalizePhone.js"],"names":["_","require","ValidationError","normalizePhone","phone","defaultArea","trim","length","s","substr","data","leftB","indexOf","rightB","trimStart","substring","replace","module","exports"],"mappings":";;;;AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAQC,OAAO,CAAC,YAAD,CAArB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAsBD,OAAO,CAAC,iBAAD,CAAnC;;AAEA,SAASE,cAAT,CAAwBC,KAAxB,EAA+BC,WAA/B,EAA4C;AACxC,MAAID,KAAJ,EAAW;AACPA,IAAAA,KAAK,GAAGA,KAAK,CAACE,IAAN,EAAR;;AAEA,QAAIF,KAAK,CAACG,MAAN,GAAe,CAAnB,EAAsB;AAClB,YAAMC,CAAC,GAAGJ,KAAK,CAAC,CAAD,CAAf;;AACA,UAAII,CAAC,KAAK,GAAV,EAAe,CAEd,CAFD,MAEO,IAAIA,CAAC,KAAK,GAAV,EAAe;AAClB,YAAIJ,KAAK,CAAC,CAAD,CAAL,KAAa,GAAjB,EAAsB;AAClBA,UAAAA,KAAK,GAAG,MAAMA,KAAK,CAACK,MAAN,CAAa,CAAb,CAAd;AACH,SAFD,MAEO;AACH,cAAIJ,WAAW,IAAI,IAAnB,EAAyB;AACrB,kBAAM,IAAIH,eAAJ,CACF,+DADE,EAEF;AACIQ,cAAAA,IAAI,EAAEN;AADV,aAFE,CAAN;AAMH;;AACDA,UAAAA,KAAK,GAAGC,WAAW,GAAGD,KAAK,CAACK,MAAN,CAAa,CAAb,CAAtB;AACH;AACJ,OAdM,MAcA;AACH,YAAIJ,WAAW,IAAI,IAAnB,EAAyB;AACrB,gBAAM,IAAIH,eAAJ,CACF,+DADE,EAEF;AACIQ,YAAAA,IAAI,EAAEN;AADV,WAFE,CAAN;AAMH;;AACDA,QAAAA,KAAK,GAAGC,WAAW,GAAGD,KAAtB;AACH;;AAED,YAAMO,KAAK,GAAGP,KAAK,CAACQ,OAAN,CAAc,GAAd,CAAd;AACA,YAAMC,MAAM,GAAGT,KAAK,CAACQ,OAAN,CAAc,GAAd,CAAf;;AAEA,UAAID,KAAK,GAAG,CAAR,IAAaE,MAAM,GAAGF,KAA1B,EAAiC;AAC7BP,QAAAA,KAAK,GACDA,KAAK,CAACK,MAAN,CAAa,CAAb,EAAgBE,KAAhB,IACAX,CAAC,CAACc,SAAF,CAAYV,KAAK,CAACW,SAAN,CAAgBJ,KAAK,GAAG,CAAxB,EAA2BE,MAA3B,CAAZ,EAAgD,GAAhD,CADA,GAEAT,KAAK,CAACK,MAAN,CAAaI,MAAM,GAAG,CAAtB,CAHJ;AAIH;;AAEDT,MAAAA,KAAK,GAAGA,KAAK,CAACY,OAAN,CAAc,MAAd,EAAsB,EAAtB,CAAR;AACH;AACJ;;AAED,SAAOZ,KAAP;AACH;;AAEDa,MAAM,CAACC,OAAP,GAAiBf,cAAjB","sourcesContent":["const { _ } = require('@genx/july');\nconst { ValidationError } = require('../utils/Errors');\n\nfunction normalizePhone(phone, defaultArea) {\n    if (phone) {\n        phone = phone.trim();\n\n        if (phone.length > 0) {\n            const s = phone[0];\n            if (s === '+') {\n                // nothing\n            } else if (s === '0') {\n                if (phone[1] === '0') {\n                    phone = '+' + phone.substr(2);\n                } else {\n                    if (defaultArea == null) {\n                        throw new ValidationError(\n                            'The mobile phone number must be supplied with a country code.',\n                            {\n                                data: phone,\n                            }\n                        );\n                    }\n                    phone = defaultArea + phone.substr(1);\n                }\n            } else {\n                if (defaultArea == null) {\n                    throw new ValidationError(\n                        'The mobile phone number must be supplied with a country code.',\n                        {\n                            data: phone,\n                        }\n                    );\n                }\n                phone = defaultArea + phone;\n            }\n\n            const leftB = phone.indexOf('(');\n            const rightB = phone.indexOf(')');\n\n            if (leftB > 0 && rightB > leftB) {\n                phone =\n                    phone.substr(0, leftB) +\n                    _.trimStart(phone.substring(leftB + 1, rightB), '0') +\n                    phone.substr(rightB + 1);\n            }\n\n            phone = phone.replace(/ |-/g, '');\n        }\n    }\n\n    return phone;\n}\n\nmodule.exports = normalizePhone;\n"],"file":"normalizePhone.js"}