"use strict";

require("source-map-support/register");

const FEATURE_NAME = 'atLeastOneNotNull';

function feature(entity, [fields]) {
  if (!fields) {
    throw new Error('Missing field names!');
  }

  Array.isArray(fields) || (fields = [fields]);
  entity.addFeature(FEATURE_NAME, fields, true).on('afterAddingFields', () => {
    fields.forEach(fieldName => {
      let field = entity.fields[fieldName];

      if (!field) {
        throw new Error('Required field "' + fieldName + '" not exist.');
      }

      field.optional = true;
    });
  });
}

module.exports = feature;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9sYW5nL2VudGl0eUZlYXR1cmVzL2F0TGVhc3RPbmVOb3ROdWxsLmpzIl0sIm5hbWVzIjpbIkZFQVRVUkVfTkFNRSIsImZlYXR1cmUiLCJlbnRpdHkiLCJmaWVsZHMiLCJFcnJvciIsIkFycmF5IiwiaXNBcnJheSIsImFkZEZlYXR1cmUiLCJvbiIsImZvckVhY2giLCJmaWVsZE5hbWUiLCJmaWVsZCIsIm9wdGlvbmFsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUFFQSxNQUFNQSxZQUFZLEdBQUcsbUJBQXJCOztBQVlBLFNBQVNDLE9BQVQsQ0FBaUJDLE1BQWpCLEVBQXlCLENBQUVDLE1BQUYsQ0FBekIsRUFBcUM7QUFDakMsTUFBSSxDQUFDQSxNQUFMLEVBQWE7QUFDVCxVQUFNLElBQUlDLEtBQUosQ0FBVSxzQkFBVixDQUFOO0FBQ0g7O0FBRURDLEVBQUFBLEtBQUssQ0FBQ0MsT0FBTixDQUFjSCxNQUFkLE1BQTBCQSxNQUFNLEdBQUcsQ0FBRUEsTUFBRixDQUFuQztBQUVBRCxFQUFBQSxNQUFNLENBQUNLLFVBQVAsQ0FBa0JQLFlBQWxCLEVBQWdDRyxNQUFoQyxFQUF3QyxJQUF4QyxFQUE4Q0ssRUFBOUMsQ0FBaUQsbUJBQWpELEVBQXNFLE1BQU07QUFDeEVMLElBQUFBLE1BQU0sQ0FBQ00sT0FBUCxDQUFlQyxTQUFTLElBQUk7QUFDeEIsVUFBSUMsS0FBSyxHQUFHVCxNQUFNLENBQUNDLE1BQVAsQ0FBY08sU0FBZCxDQUFaOztBQUVBLFVBQUksQ0FBQ0MsS0FBTCxFQUFZO0FBQ1IsY0FBTSxJQUFJUCxLQUFKLENBQVUscUJBQXFCTSxTQUFyQixHQUFpQyxjQUEzQyxDQUFOO0FBQ0g7O0FBRURDLE1BQUFBLEtBQUssQ0FBQ0MsUUFBTixHQUFpQixJQUFqQjtBQUNILEtBUkQ7QUFTSCxHQVZEO0FBV0g7O0FBRURDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQmIsT0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuY29uc3QgRkVBVFVSRV9OQU1FID0gJ2F0TGVhc3RPbmVOb3ROdWxsJztcblxuLyoqXG4gKiBBIHJ1bGUgc3BlY2lmaWVzIGF0IGxlYXN0IG9uZSBmaWVsZCBub3QgbnVsbCwgZS5nLiBlbWFpbCBvciBtb2JpbGUuXG4gKiBAbW9kdWxlIEVudGl0eUZlYXR1cmVfQXRMZWFzdE9uZU5vdE51bGxcbiAqL1xuXG4vKipcbiAqIEluaXRpYWxpemUgdGhlIGZlYXR1cmVcbiAqIEBwYXJhbSB7T29sb25nRW50aXR5fSBlbnRpdHkgLSBFbnRpdHkgdG8gYXBwbHkgdGhpcyBmZWF0dXJlXG4gKiBAcGFyYW0ge2FycmF5fSBmaWVsZHMgLSBMaXN0IG9mIGZpZWxkIG5hbWVzXG4gKi9cbmZ1bmN0aW9uIGZlYXR1cmUoZW50aXR5LCBbIGZpZWxkcyBdKSB7XG4gICAgaWYgKCFmaWVsZHMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIGZpZWxkIG5hbWVzIScpO1xuICAgIH1cblxuICAgIEFycmF5LmlzQXJyYXkoZmllbGRzKSB8fCAoZmllbGRzID0gWyBmaWVsZHMgXSk7XG5cbiAgICBlbnRpdHkuYWRkRmVhdHVyZShGRUFUVVJFX05BTUUsIGZpZWxkcywgdHJ1ZSkub24oJ2FmdGVyQWRkaW5nRmllbGRzJywgKCkgPT4ge1xuICAgICAgICBmaWVsZHMuZm9yRWFjaChmaWVsZE5hbWUgPT4ge1xuICAgICAgICAgICAgbGV0IGZpZWxkID0gZW50aXR5LmZpZWxkc1tmaWVsZE5hbWVdO1xuXG4gICAgICAgICAgICBpZiAoIWZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBmaWVsZCBcIicgKyBmaWVsZE5hbWUgKyAnXCIgbm90IGV4aXN0LicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmaWVsZC5vcHRpb25hbCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZlYXR1cmU7Il19