"use strict";

require("source-map-support/register");

const {
  _
} = require('rk-utils');

const SupportedDrivers = ['mysql', 'mongodb', 'rabbitmq'];
const JsPrimitiveTypes = new Set(['number', 'boolean', 'string', 'symbol', 'undefined']);

function mergeCondition(condition1, condition2, operator = '$and') {
  if (_.isEmpty(condition1)) {
    return condition2;
  }

  if (_.isEmpty(condition2)) {
    return condition1;
  }

  return {
    [operator]: [condition1, condition2]
  };
}

exports.isNothing = v => _.isNil(v) || _.isNaN(v);

exports.isPrimitive = v => JsPrimitiveTypes.has(typeof v);

exports.isQuoted = s => (s.startsWith("'") || s.startsWith('"')) && s[0] === s[s.length - 1];

exports.isQuotedWith = (s, q) => s.startsWith(q) && s[0] === s[s.length - 1];

exports.makeDataSourceName = (driver, schema) => driver + '.' + schema;

exports.extractDriverAndConnectorName = id => id.split('.');

exports.mergeCondition = mergeCondition;
exports.SupportedDrivers = Object.freeze(SupportedDrivers);

const $col = name => ({
  oorType: 'ColumnReference',
  name
});

const $expr = (left, op, right) => ({
  oorType: 'BinaryExpression',
  left,
  op,
  right
});

const $f = (name, ...args) => ({
  oorType: 'Function',
  name,
  args
});

const $inc = (field, increment) => $expr($col(field), '+', increment);

const $dataSet = (model, query) => ({
  oorType: 'DataSet',
  model,
  query
});

const $sql = sql => ({
  oorType: 'SQL',
  sql
});

exports.$col = $col;
exports.$expr = $expr;
exports.$f = $f;
exports.$func = $f;
exports.$inc = $inc;
exports.$increase = $inc;
exports.$dataSet = $dataSet;
exports.$select = $dataSet;
exports.$sql = $sql;

exports.hasValueIn = (arrayOfColl, key) => _.find(arrayOfColl, coll => coll[key] != null);

exports.getValueFrom = (arrayOfColl, key) => {
  const l = arrayOfColl.length;

  for (let i = 0; i < l; i++) {
    const coll = arrayOfColl[i];
    const value = coll && coll[key];
    if (value != null) return value;
  }

  return undefined;
};

const mapFilterReducerArray = (predicate, mapper) => (result, value) => {
  if (predicate(value)) {
    result.push(mapper(value));
  }

  return result;
};

const mapFilterReducerObject = (predicate, mapper) => (result, value, key) => {
  if (predicate(value)) {
    result[key] = mapper(value);
  }

  return result;
};

exports.mapFilter = (collection, predicate, mapper) => Array.isArray(collection) ? _.reduce(collection, mapFilterReducerArray(predicate, mapper), []) : _.reduce(collection, mapFilterReducerObject(predicate, mapper), {});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9sYW5nLmpzIl0sIm5hbWVzIjpbIl8iLCJyZXF1aXJlIiwiU3VwcG9ydGVkRHJpdmVycyIsIkpzUHJpbWl0aXZlVHlwZXMiLCJTZXQiLCJtZXJnZUNvbmRpdGlvbiIsImNvbmRpdGlvbjEiLCJjb25kaXRpb24yIiwib3BlcmF0b3IiLCJpc0VtcHR5IiwiZXhwb3J0cyIsImlzTm90aGluZyIsInYiLCJpc05pbCIsImlzTmFOIiwiaXNQcmltaXRpdmUiLCJoYXMiLCJpc1F1b3RlZCIsInMiLCJzdGFydHNXaXRoIiwibGVuZ3RoIiwiaXNRdW90ZWRXaXRoIiwicSIsIm1ha2VEYXRhU291cmNlTmFtZSIsImRyaXZlciIsInNjaGVtYSIsImV4dHJhY3REcml2ZXJBbmRDb25uZWN0b3JOYW1lIiwiaWQiLCJzcGxpdCIsIk9iamVjdCIsImZyZWV6ZSIsIiRjb2wiLCJuYW1lIiwib29yVHlwZSIsIiRleHByIiwibGVmdCIsIm9wIiwicmlnaHQiLCIkZiIsImFyZ3MiLCIkaW5jIiwiZmllbGQiLCJpbmNyZW1lbnQiLCIkZGF0YVNldCIsIm1vZGVsIiwicXVlcnkiLCIkc3FsIiwic3FsIiwiJGZ1bmMiLCIkaW5jcmVhc2UiLCIkc2VsZWN0IiwiaGFzVmFsdWVJbiIsImFycmF5T2ZDb2xsIiwia2V5IiwiZmluZCIsImNvbGwiLCJnZXRWYWx1ZUZyb20iLCJsIiwiaSIsInZhbHVlIiwidW5kZWZpbmVkIiwibWFwRmlsdGVyUmVkdWNlckFycmF5IiwicHJlZGljYXRlIiwibWFwcGVyIiwicmVzdWx0IiwicHVzaCIsIm1hcEZpbHRlclJlZHVjZXJPYmplY3QiLCJtYXBGaWx0ZXIiLCJjb2xsZWN0aW9uIiwiQXJyYXkiLCJpc0FycmF5IiwicmVkdWNlIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLE1BQU07QUFBRUEsRUFBQUE7QUFBRixJQUFRQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFFQSxNQUFNQyxnQkFBZ0IsR0FBRyxDQUFFLE9BQUYsRUFBVyxTQUFYLEVBQXNCLFVBQXRCLENBQXpCO0FBQ0EsTUFBTUMsZ0JBQWdCLEdBQUcsSUFBSUMsR0FBSixDQUFRLENBQUUsUUFBRixFQUFZLFNBQVosRUFBdUIsUUFBdkIsRUFBaUMsUUFBakMsRUFBMkMsV0FBM0MsQ0FBUixDQUF6Qjs7QUFTQSxTQUFTQyxjQUFULENBQXdCQyxVQUF4QixFQUFvQ0MsVUFBcEMsRUFBZ0RDLFFBQVEsR0FBRyxNQUEzRCxFQUFtRTtBQUMvRCxNQUFJUixDQUFDLENBQUNTLE9BQUYsQ0FBVUgsVUFBVixDQUFKLEVBQTJCO0FBQ3ZCLFdBQU9DLFVBQVA7QUFDSDs7QUFFRCxNQUFJUCxDQUFDLENBQUNTLE9BQUYsQ0FBVUYsVUFBVixDQUFKLEVBQTJCO0FBQ3ZCLFdBQU9ELFVBQVA7QUFDSDs7QUFFRCxTQUFPO0FBQUUsS0FBQ0UsUUFBRCxHQUFZLENBQUVGLFVBQUYsRUFBY0MsVUFBZDtBQUFkLEdBQVA7QUFDSDs7QUFFREcsT0FBTyxDQUFDQyxTQUFSLEdBQW9CQyxDQUFDLElBQUlaLENBQUMsQ0FBQ2EsS0FBRixDQUFRRCxDQUFSLEtBQWNaLENBQUMsQ0FBQ2MsS0FBRixDQUFRRixDQUFSLENBQXZDOztBQUNBRixPQUFPLENBQUNLLFdBQVIsR0FBc0JILENBQUMsSUFBSVQsZ0JBQWdCLENBQUNhLEdBQWpCLENBQXFCLE9BQU9KLENBQTVCLENBQTNCOztBQUNBRixPQUFPLENBQUNPLFFBQVIsR0FBbUJDLENBQUMsSUFBSSxDQUFDQSxDQUFDLENBQUNDLFVBQUYsQ0FBYSxHQUFiLEtBQXFCRCxDQUFDLENBQUNDLFVBQUYsQ0FBYSxHQUFiLENBQXRCLEtBQTRDRCxDQUFDLENBQUMsQ0FBRCxDQUFELEtBQVNBLENBQUMsQ0FBQ0EsQ0FBQyxDQUFDRSxNQUFGLEdBQVMsQ0FBVixDQUE5RTs7QUFDQVYsT0FBTyxDQUFDVyxZQUFSLEdBQXVCLENBQUNILENBQUQsRUFBSUksQ0FBSixLQUFXSixDQUFDLENBQUNDLFVBQUYsQ0FBYUcsQ0FBYixLQUFtQkosQ0FBQyxDQUFDLENBQUQsQ0FBRCxLQUFTQSxDQUFDLENBQUNBLENBQUMsQ0FBQ0UsTUFBRixHQUFTLENBQVYsQ0FBL0Q7O0FBQ0FWLE9BQU8sQ0FBQ2Esa0JBQVIsR0FBNkIsQ0FBQ0MsTUFBRCxFQUFTQyxNQUFULEtBQXFCRCxNQUFNLEdBQUcsR0FBVCxHQUFlQyxNQUFqRTs7QUFDQWYsT0FBTyxDQUFDZ0IsNkJBQVIsR0FBd0NDLEVBQUUsSUFBSUEsRUFBRSxDQUFDQyxLQUFILENBQVMsR0FBVCxDQUE5Qzs7QUFDQWxCLE9BQU8sQ0FBQ0wsY0FBUixHQUF5QkEsY0FBekI7QUFDQUssT0FBTyxDQUFDUixnQkFBUixHQUEyQjJCLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjNUIsZ0JBQWQsQ0FBM0I7O0FBRUEsTUFBTTZCLElBQUksR0FBSUMsSUFBRCxLQUFXO0FBQUVDLEVBQUFBLE9BQU8sRUFBRSxpQkFBWDtBQUE4QkQsRUFBQUE7QUFBOUIsQ0FBWCxDQUFiOztBQUNBLE1BQU1FLEtBQUssR0FBRyxDQUFDQyxJQUFELEVBQU9DLEVBQVAsRUFBV0MsS0FBWCxNQUFxQjtBQUFFSixFQUFBQSxPQUFPLEVBQUUsa0JBQVg7QUFBK0JFLEVBQUFBLElBQS9CO0FBQXFDQyxFQUFBQSxFQUFyQztBQUF5Q0MsRUFBQUE7QUFBekMsQ0FBckIsQ0FBZDs7QUFDQSxNQUFNQyxFQUFFLEdBQUcsQ0FBQ04sSUFBRCxFQUFPLEdBQUdPLElBQVYsTUFBb0I7QUFBRU4sRUFBQUEsT0FBTyxFQUFFLFVBQVg7QUFBdUJELEVBQUFBLElBQXZCO0FBQTZCTyxFQUFBQTtBQUE3QixDQUFwQixDQUFYOztBQUNBLE1BQU1DLElBQUksR0FBRyxDQUFDQyxLQUFELEVBQVFDLFNBQVIsS0FBc0JSLEtBQUssQ0FBQ0gsSUFBSSxDQUFDVSxLQUFELENBQUwsRUFBYyxHQUFkLEVBQW1CQyxTQUFuQixDQUF4Qzs7QUFDQSxNQUFNQyxRQUFRLEdBQUcsQ0FBQ0MsS0FBRCxFQUFRQyxLQUFSLE1BQW1CO0FBQUVaLEVBQUFBLE9BQU8sRUFBRSxTQUFYO0FBQXNCVyxFQUFBQSxLQUF0QjtBQUE2QkMsRUFBQUE7QUFBN0IsQ0FBbkIsQ0FBakI7O0FBQ0EsTUFBTUMsSUFBSSxHQUFJQyxHQUFELEtBQVU7QUFBRWQsRUFBQUEsT0FBTyxFQUFFLEtBQVg7QUFBa0JjLEVBQUFBO0FBQWxCLENBQVYsQ0FBYjs7QUFFQXJDLE9BQU8sQ0FBQ3FCLElBQVIsR0FBZUEsSUFBZjtBQUNBckIsT0FBTyxDQUFDd0IsS0FBUixHQUFnQkEsS0FBaEI7QUFDQXhCLE9BQU8sQ0FBQzRCLEVBQVIsR0FBYUEsRUFBYjtBQUNBNUIsT0FBTyxDQUFDc0MsS0FBUixHQUFnQlYsRUFBaEI7QUFDQTVCLE9BQU8sQ0FBQzhCLElBQVIsR0FBZUEsSUFBZjtBQUNBOUIsT0FBTyxDQUFDdUMsU0FBUixHQUFvQlQsSUFBcEI7QUFDQTlCLE9BQU8sQ0FBQ2lDLFFBQVIsR0FBbUJBLFFBQW5CO0FBQ0FqQyxPQUFPLENBQUN3QyxPQUFSLEdBQWtCUCxRQUFsQjtBQUNBakMsT0FBTyxDQUFDb0MsSUFBUixHQUFlQSxJQUFmOztBQUVBcEMsT0FBTyxDQUFDeUMsVUFBUixHQUFxQixDQUFDQyxXQUFELEVBQWNDLEdBQWQsS0FBc0JyRCxDQUFDLENBQUNzRCxJQUFGLENBQU9GLFdBQVAsRUFBb0JHLElBQUksSUFBSUEsSUFBSSxDQUFDRixHQUFELENBQUosSUFBYSxJQUF6QyxDQUEzQzs7QUFDQTNDLE9BQU8sQ0FBQzhDLFlBQVIsR0FBdUIsQ0FBQ0osV0FBRCxFQUFjQyxHQUFkLEtBQXNCO0FBQ3pDLFFBQU1JLENBQUMsR0FBR0wsV0FBVyxDQUFDaEMsTUFBdEI7O0FBQ0EsT0FBSyxJQUFJc0MsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR0QsQ0FBcEIsRUFBdUJDLENBQUMsRUFBeEIsRUFBNEI7QUFDeEIsVUFBTUgsSUFBSSxHQUFHSCxXQUFXLENBQUNNLENBQUQsQ0FBeEI7QUFDQSxVQUFNQyxLQUFLLEdBQUdKLElBQUksSUFBSUEsSUFBSSxDQUFDRixHQUFELENBQTFCO0FBQ0EsUUFBSU0sS0FBSyxJQUFJLElBQWIsRUFBbUIsT0FBT0EsS0FBUDtBQUN0Qjs7QUFDRCxTQUFPQyxTQUFQO0FBQ0gsQ0FSRDs7QUFVQSxNQUFNQyxxQkFBcUIsR0FBRyxDQUFDQyxTQUFELEVBQVlDLE1BQVosS0FBdUIsQ0FBQ0MsTUFBRCxFQUFTTCxLQUFULEtBQW1CO0FBQ3BFLE1BQUlHLFNBQVMsQ0FBQ0gsS0FBRCxDQUFiLEVBQXNCO0FBQ2xCSyxJQUFBQSxNQUFNLENBQUNDLElBQVAsQ0FBWUYsTUFBTSxDQUFDSixLQUFELENBQWxCO0FBQ0g7O0FBQ0QsU0FBT0ssTUFBUDtBQUNILENBTEQ7O0FBT0EsTUFBTUUsc0JBQXNCLEdBQUcsQ0FBQ0osU0FBRCxFQUFZQyxNQUFaLEtBQXVCLENBQUNDLE1BQUQsRUFBU0wsS0FBVCxFQUFnQk4sR0FBaEIsS0FBd0I7QUFDMUUsTUFBSVMsU0FBUyxDQUFDSCxLQUFELENBQWIsRUFBc0I7QUFDbEJLLElBQUFBLE1BQU0sQ0FBQ1gsR0FBRCxDQUFOLEdBQWNVLE1BQU0sQ0FBQ0osS0FBRCxDQUFwQjtBQUNIOztBQUNELFNBQU9LLE1BQVA7QUFDSCxDQUxEOztBQVlBdEQsT0FBTyxDQUFDeUQsU0FBUixHQUFvQixDQUFDQyxVQUFELEVBQWFOLFNBQWIsRUFBd0JDLE1BQXhCLEtBQ2hCTSxLQUFLLENBQUNDLE9BQU4sQ0FBY0YsVUFBZCxJQUNNcEUsQ0FBQyxDQUFDdUUsTUFBRixDQUFTSCxVQUFULEVBQXFCUCxxQkFBcUIsQ0FBQ0MsU0FBRCxFQUFZQyxNQUFaLENBQTFDLEVBQStELEVBQS9ELENBRE4sR0FFTS9ELENBQUMsQ0FBQ3VFLE1BQUYsQ0FBU0gsVUFBVCxFQUFxQkYsc0JBQXNCLENBQUNKLFNBQUQsRUFBWUMsTUFBWixDQUEzQyxFQUFnRSxFQUFoRSxDQUhWIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0IHsgXyB9ID0gcmVxdWlyZSgncmstdXRpbHMnKTtcblxuY29uc3QgU3VwcG9ydGVkRHJpdmVycyA9IFsgJ215c3FsJywgJ21vbmdvZGInLCAncmFiYml0bXEnIF07XG5jb25zdCBKc1ByaW1pdGl2ZVR5cGVzID0gbmV3IFNldChbICdudW1iZXInLCAnYm9vbGVhbicsICdzdHJpbmcnLCAnc3ltYm9sJywgJ3VuZGVmaW5lZCcgXSk7XG5cbi8qKlxuICogTWVyZ2UgdHdvIHF1ZXJ5IGNvbmRpdGlvbnMgdXNpbmcgZ2l2ZW4gb3BlcmF0b3IuXG4gKiBAcGFyYW0geyp9IGNvbmRpdGlvbjEgXG4gKiBAcGFyYW0geyp9IGNvbmRpdGlvbjIgXG4gKiBAcGFyYW0geyp9IG9wZXJhdG9yIFxuICogQHJldHVybnMge29iamVjdH1cbiAqL1xuZnVuY3Rpb24gbWVyZ2VDb25kaXRpb24oY29uZGl0aW9uMSwgY29uZGl0aW9uMiwgb3BlcmF0b3IgPSAnJGFuZCcpIHsgICAgICAgIFxuICAgIGlmIChfLmlzRW1wdHkoY29uZGl0aW9uMSkpIHtcbiAgICAgICAgcmV0dXJuIGNvbmRpdGlvbjI7XG4gICAgfVxuXG4gICAgaWYgKF8uaXNFbXB0eShjb25kaXRpb24yKSkge1xuICAgICAgICByZXR1cm4gY29uZGl0aW9uMTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBbb3BlcmF0b3JdOiBbIGNvbmRpdGlvbjEsIGNvbmRpdGlvbjIgXSB9O1xufVxuXG5leHBvcnRzLmlzTm90aGluZyA9IHYgPT4gXy5pc05pbCh2KSB8fCBfLmlzTmFOKHYpO1xuZXhwb3J0cy5pc1ByaW1pdGl2ZSA9IHYgPT4gSnNQcmltaXRpdmVUeXBlcy5oYXModHlwZW9mIHYpO1xuZXhwb3J0cy5pc1F1b3RlZCA9IHMgPT4gKHMuc3RhcnRzV2l0aChcIidcIikgfHwgcy5zdGFydHNXaXRoKCdcIicpKSAmJiBzWzBdID09PSBzW3MubGVuZ3RoLTFdO1xuZXhwb3J0cy5pc1F1b3RlZFdpdGggPSAocywgcSkgPT4gKHMuc3RhcnRzV2l0aChxKSAmJiBzWzBdID09PSBzW3MubGVuZ3RoLTFdKTtcbmV4cG9ydHMubWFrZURhdGFTb3VyY2VOYW1lID0gKGRyaXZlciwgc2NoZW1hKSA9PiAoZHJpdmVyICsgJy4nICsgc2NoZW1hKTtcbmV4cG9ydHMuZXh0cmFjdERyaXZlckFuZENvbm5lY3Rvck5hbWUgPSBpZCA9PiBpZC5zcGxpdCgnLicpO1xuZXhwb3J0cy5tZXJnZUNvbmRpdGlvbiA9IG1lcmdlQ29uZGl0aW9uO1xuZXhwb3J0cy5TdXBwb3J0ZWREcml2ZXJzID0gT2JqZWN0LmZyZWV6ZShTdXBwb3J0ZWREcml2ZXJzKTtcblxuY29uc3QgJGNvbCA9IChuYW1lKSA9PiAoeyBvb3JUeXBlOiAnQ29sdW1uUmVmZXJlbmNlJywgbmFtZSB9KTtcbmNvbnN0ICRleHByID0gKGxlZnQsIG9wLCByaWdodCkgPT4oeyBvb3JUeXBlOiAnQmluYXJ5RXhwcmVzc2lvbicsIGxlZnQsIG9wLCByaWdodCB9KTtcbmNvbnN0ICRmID0gKG5hbWUsIC4uLmFyZ3MpID0+ICh7IG9vclR5cGU6ICdGdW5jdGlvbicsIG5hbWUsIGFyZ3MgfSk7XG5jb25zdCAkaW5jID0gKGZpZWxkLCBpbmNyZW1lbnQpID0+ICRleHByKCRjb2woZmllbGQpLCAnKycsIGluY3JlbWVudCk7XG5jb25zdCAkZGF0YVNldCA9IChtb2RlbCwgcXVlcnkpID0+ICh7IG9vclR5cGU6ICdEYXRhU2V0JywgbW9kZWwsIHF1ZXJ5IH0pO1xuY29uc3QgJHNxbCA9IChzcWwpID0+ICh7IG9vclR5cGU6ICdTUUwnLCBzcWwgfSk7XG5cbmV4cG9ydHMuJGNvbCA9ICRjb2w7XG5leHBvcnRzLiRleHByID0gJGV4cHI7XG5leHBvcnRzLiRmID0gJGY7XG5leHBvcnRzLiRmdW5jID0gJGY7XG5leHBvcnRzLiRpbmMgPSAkaW5jXG5leHBvcnRzLiRpbmNyZWFzZSA9ICRpbmNcbmV4cG9ydHMuJGRhdGFTZXQgPSAkZGF0YVNldDtcbmV4cG9ydHMuJHNlbGVjdCA9ICRkYXRhU2V0O1xuZXhwb3J0cy4kc3FsID0gJHNxbDtcblxuZXhwb3J0cy5oYXNWYWx1ZUluID0gKGFycmF5T2ZDb2xsLCBrZXkpID0+IF8uZmluZChhcnJheU9mQ29sbCwgY29sbCA9PiBjb2xsW2tleV0gIT0gbnVsbCk7XG5leHBvcnRzLmdldFZhbHVlRnJvbSA9IChhcnJheU9mQ29sbCwga2V5KSA9PiB7XG4gICAgY29uc3QgbCA9IGFycmF5T2ZDb2xsLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGw7IGkrKykge1xuICAgICAgICBjb25zdCBjb2xsID0gYXJyYXlPZkNvbGxbaV07XG4gICAgICAgIGNvbnN0IHZhbHVlID0gY29sbCAmJiBjb2xsW2tleV07XG4gICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5jb25zdCBtYXBGaWx0ZXJSZWR1Y2VyQXJyYXkgPSAocHJlZGljYXRlLCBtYXBwZXIpID0+IChyZXN1bHQsIHZhbHVlKSA9PiB7XG4gICAgaWYgKHByZWRpY2F0ZSh2YWx1ZSkpIHtcbiAgICAgICAgcmVzdWx0LnB1c2gobWFwcGVyKHZhbHVlKSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5jb25zdCBtYXBGaWx0ZXJSZWR1Y2VyT2JqZWN0ID0gKHByZWRpY2F0ZSwgbWFwcGVyKSA9PiAocmVzdWx0LCB2YWx1ZSwga2V5KSA9PiB7XG4gICAgaWYgKHByZWRpY2F0ZSh2YWx1ZSkpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBtYXBwZXIodmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge29iamVjdH0gY29sbGVjdGlvblxuICogQHBhcmFtIHtmdW5jdGlvbn0gcHJlZGljYXRlXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBtYXBwZXIgXG4gKi9cbmV4cG9ydHMubWFwRmlsdGVyID0gKGNvbGxlY3Rpb24sIHByZWRpY2F0ZSwgbWFwcGVyKSA9PlxuICAgIEFycmF5LmlzQXJyYXkoY29sbGVjdGlvbilcbiAgICAgICAgPyBfLnJlZHVjZShjb2xsZWN0aW9uLCBtYXBGaWx0ZXJSZWR1Y2VyQXJyYXkocHJlZGljYXRlLCBtYXBwZXIpLCBbXSlcbiAgICAgICAgOiBfLnJlZHVjZShjb2xsZWN0aW9uLCBtYXBGaWx0ZXJSZWR1Y2VyT2JqZWN0KHByZWRpY2F0ZSwgbWFwcGVyKSwge30pO1xuIl19