"use strict";

require("source-map-support/register");

const path = require('path');

const {
  fs,
  tryRequire
} = require('@genx/sys');

module.exports = async (url, targetFile) => {
  const request = tryRequire('superagent', __dirname);
  const dirName = path.dirname(targetFile);
  await fs.ensureDir(dirName);
  const stream = fs.createWriteStream(targetFile);
  await new Promise((resolve, reject) => {
    stream.on('close', () => {
      resolve();
    });
    stream.on('error', err => {
      reject(err);
    });
    request.get(url).pipe(stream);
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9kb3dubG9hZC5qcyJdLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsImZzIiwidHJ5UmVxdWlyZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJ1cmwiLCJ0YXJnZXRGaWxlIiwicmVxdWVzdCIsIl9fZGlybmFtZSIsImRpck5hbWUiLCJkaXJuYW1lIiwiZW5zdXJlRGlyIiwic3RyZWFtIiwiY3JlYXRlV3JpdGVTdHJlYW0iLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uIiwiZXJyIiwiZ2V0IiwicGlwZSJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQSxFQUFGO0FBQU1DLEVBQUFBO0FBQU4sSUFBcUJGLE9BQU8sQ0FBQyxXQUFELENBQWxDOztBQUVBRyxNQUFNLENBQUNDLE9BQVAsR0FBaUIsT0FBT0MsR0FBUCxFQUFZQyxVQUFaLEtBQTJCO0FBQ3hDLFFBQU1DLE9BQU8sR0FBR0wsVUFBVSxDQUFDLFlBQUQsRUFBZU0sU0FBZixDQUExQjtBQUVBLFFBQU1DLE9BQU8sR0FBR1YsSUFBSSxDQUFDVyxPQUFMLENBQWFKLFVBQWIsQ0FBaEI7QUFFQSxRQUFNTCxFQUFFLENBQUNVLFNBQUgsQ0FBYUYsT0FBYixDQUFOO0FBRUEsUUFBTUcsTUFBTSxHQUFHWCxFQUFFLENBQUNZLGlCQUFILENBQXFCUCxVQUFyQixDQUFmO0FBRUEsUUFBTSxJQUFJUSxPQUFKLENBQVksQ0FBQ0MsT0FBRCxFQUFVQyxNQUFWLEtBQXFCO0FBQ25DSixJQUFBQSxNQUFNLENBQUNLLEVBQVAsQ0FBVSxPQUFWLEVBQW1CLE1BQU07QUFDckJGLE1BQUFBLE9BQU87QUFDVixLQUZEO0FBSUFILElBQUFBLE1BQU0sQ0FBQ0ssRUFBUCxDQUFVLE9BQVYsRUFBb0JDLEdBQUQsSUFBUztBQUN4QkYsTUFBQUEsTUFBTSxDQUFDRSxHQUFELENBQU47QUFDSCxLQUZEO0FBSUFYLElBQUFBLE9BQU8sQ0FBQ1ksR0FBUixDQUFZZCxHQUFaLEVBQWlCZSxJQUFqQixDQUFzQlIsTUFBdEI7QUFDSCxHQVZLLENBQU47QUFXSCxDQXBCRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCB7IGZzLCB0cnlSZXF1aXJlIH0gPSByZXF1aXJlKCdAZ2VueC9zeXMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBhc3luYyAodXJsLCB0YXJnZXRGaWxlKSA9PiB7XG4gICAgY29uc3QgcmVxdWVzdCA9IHRyeVJlcXVpcmUoJ3N1cGVyYWdlbnQnLCBfX2Rpcm5hbWUpO1xuXG4gICAgY29uc3QgZGlyTmFtZSA9IHBhdGguZGlybmFtZSh0YXJnZXRGaWxlKTtcblxuICAgIGF3YWl0IGZzLmVuc3VyZURpcihkaXJOYW1lKTtcblxuICAgIGNvbnN0IHN0cmVhbSA9IGZzLmNyZWF0ZVdyaXRlU3RyZWFtKHRhcmdldEZpbGUpO1xuXG4gICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBzdHJlYW0ub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBzdHJlYW0ub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJlcXVlc3QuZ2V0KHVybCkucGlwZShzdHJlYW0pOyAgICBcbiAgICB9KTtcbn07XG4gICAgIl19