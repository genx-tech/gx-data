"use strict";

require("source-map-support/register");

const path = require('path');

const {
  fs,
  Promise
} = require('rk-utils');

const {
  tryRequire
} = require('./lib');

module.exports = async (url, targetFile) => {
  const request = tryRequire('superagent');
  const dirName = path.dirname(targetFile);
  await fs.ensureDir(dirName);
  const stream = fs.createWriteStream(targetFile);
  await new Promise((resolve, reject) => {
    stream.on('close', () => {
      resolve();
    });
    stream.on('error', err => {
      reject(err);
    });
    request.get(url).pipe(stream);
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9kb3dubG9hZC5qcyJdLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsImZzIiwiUHJvbWlzZSIsInRyeVJlcXVpcmUiLCJtb2R1bGUiLCJleHBvcnRzIiwidXJsIiwidGFyZ2V0RmlsZSIsInJlcXVlc3QiLCJkaXJOYW1lIiwiZGlybmFtZSIsImVuc3VyZURpciIsInN0cmVhbSIsImNyZWF0ZVdyaXRlU3RyZWFtIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uIiwiZXJyIiwiZ2V0IiwicGlwZSJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQSxFQUFGO0FBQU1DLEVBQUFBO0FBQU4sSUFBa0JGLE9BQU8sQ0FBQyxVQUFELENBQS9COztBQUNBLE1BQU07QUFBRUcsRUFBQUE7QUFBRixJQUFpQkgsT0FBTyxDQUFDLE9BQUQsQ0FBOUI7O0FBRUFJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixPQUFPQyxHQUFQLEVBQVlDLFVBQVosS0FBMkI7QUFDeEMsUUFBTUMsT0FBTyxHQUFHTCxVQUFVLENBQUMsWUFBRCxDQUExQjtBQUVBLFFBQU1NLE9BQU8sR0FBR1YsSUFBSSxDQUFDVyxPQUFMLENBQWFILFVBQWIsQ0FBaEI7QUFFQSxRQUFNTixFQUFFLENBQUNVLFNBQUgsQ0FBYUYsT0FBYixDQUFOO0FBRUEsUUFBTUcsTUFBTSxHQUFHWCxFQUFFLENBQUNZLGlCQUFILENBQXFCTixVQUFyQixDQUFmO0FBRUEsUUFBTSxJQUFJTCxPQUFKLENBQVksQ0FBQ1ksT0FBRCxFQUFVQyxNQUFWLEtBQXFCO0FBQ25DSCxJQUFBQSxNQUFNLENBQUNJLEVBQVAsQ0FBVSxPQUFWLEVBQW1CLE1BQU07QUFDckJGLE1BQUFBLE9BQU87QUFDVixLQUZEO0FBSUFGLElBQUFBLE1BQU0sQ0FBQ0ksRUFBUCxDQUFVLE9BQVYsRUFBb0JDLEdBQUQsSUFBUztBQUN4QkYsTUFBQUEsTUFBTSxDQUFDRSxHQUFELENBQU47QUFDSCxLQUZEO0FBSUFULElBQUFBLE9BQU8sQ0FBQ1UsR0FBUixDQUFZWixHQUFaLEVBQWlCYSxJQUFqQixDQUFzQlAsTUFBdEI7QUFDSCxHQVZLLENBQU47QUFXSCxDQXBCRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCB7IGZzLCBQcm9taXNlIH0gPSByZXF1aXJlKCdyay11dGlscycpO1xuY29uc3QgeyB0cnlSZXF1aXJlIH0gPSByZXF1aXJlKCcuL2xpYicpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGFzeW5jICh1cmwsIHRhcmdldEZpbGUpID0+IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gdHJ5UmVxdWlyZSgnc3VwZXJhZ2VudCcpO1xuXG4gICAgY29uc3QgZGlyTmFtZSA9IHBhdGguZGlybmFtZSh0YXJnZXRGaWxlKTtcblxuICAgIGF3YWl0IGZzLmVuc3VyZURpcihkaXJOYW1lKTtcblxuICAgIGNvbnN0IHN0cmVhbSA9IGZzLmNyZWF0ZVdyaXRlU3RyZWFtKHRhcmdldEZpbGUpO1xuXG4gICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBzdHJlYW0ub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBzdHJlYW0ub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJlcXVlc3QuZ2V0KHVybCkucGlwZShzdHJlYW0pOyAgICBcbiAgICB9KTtcbn07XG4gICAgIl19